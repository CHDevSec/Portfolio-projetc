# SentinelOne Vulnerability Intelligence Dashboard

## üìò Project Overview

The SentinelOne Vulnerability Intelligence Dashboard was designed to automate the collection, processing, and visualization of endpoint vulnerabilities across the corporate environment integrated with SentinelOne.
This system provides real-time visibility into vulnerability trends by operating system (Windows, Linux, macOS), supports false-positive suppression, and automatically triggers alerts to the #infrasec Slack channel for proactive response by the Infrastructure Security team.

The solution uses a Python API consumer that periodically queries SentinelOne to retrieve vulnerability and endpoint telemetry data.
These datasets are stored in a MySQL database, orchestrated by Node-RED for weekly and monthly updates, and visualized in Grafana, which manages threshold-based alerting and real-time monitoring.

## üß† System Architecture
```
[SENTINELONE API]
       ‚Üì
 [PYTHON CONSUMER]
       ‚Üì
 [MYSQL DATABASE] ‚Üê‚Üí [NODE-RED AUTOMATION]
       ‚Üì
 [GRAFANA DASHBOARD]
       ‚Üì
 [ALERTS ‚Üí SLACK (#infrasec)]
```

### Core Components

**SentinelOne API**
The primary source of vulnerability and endpoint telemetry data.
Provides JSON-formatted responses for programmatic processing.

**Python Consumer**
The central script that handles data extraction, normalization, and filtering.

* Authenticates using SentinelOne JWT tokens.
* Implements deduplication and false-positive exclusion logic.
* Writes data in batch mode to MySQL for optimized performance.

**MySQL Database**
Centralized relational storage for vulnerability data with timestamped entries and endpoint UUID indexing for fast retrieval.

**Node-RED**
Acts as the orchestration layer, managing automation workflows:

* Weekly update (every Friday): incremental data synchronization.
* Monthly update: full data refresh and summary generation.
* Logs execution results and handles exception routing.

**Grafana**
Real-time visualization and alert management platform:

* Dashboards segmented by OS (Linux, Windows, macOS).
* Top 10 vulnerabilities (weekly/monthly).
* Severity breakdown (Critical, High, Medium, Low).
* Threshold-based alerting via webhooks.

**Slack (#infrasec)**
Integrated through Grafana webhooks to notify the Infrastructure Security team in real time when threshold limits are exceeded.

## ‚öôÔ∏è Operational Flow

### Automated Execution (Node-RED)

The Node-RED flow triggers every Friday at 05:00 AM.

1. Executes the Python consumer to retrieve new vulnerability data.
2. Logs are written to MySQL and monitored for errors or API failures.
3. If an exception occurs, an alert is automatically sent to the internal support channel.

### Data Collection and Normalization (Python)

1. Collects raw vulnerability data from SentinelOne‚Äôs API.
2. Groups and aggregates data by:
   - Operating System (Windows, Linux, macOS)
   - Severity (Critical, High, Medium, Low)
3. Automatically ignores flagged false positives based on the internal ignore list.

### Data Persistence (MySQL)

* Data is indexed and timestamped to support historical and comparative analysis.
* The schema supports weekly/monthly trend tracking and top vulnerability reporting.

### Visualization Layer (Grafana)

Displays live metrics and trend lines:

* Weekly and monthly reports per OS.
* Top 10 vulnerabilities by vendor and application.
* Total vulnerabilities and severity distribution.

Example dashboard sections:

* ‚ÄúTop 10 Vulnerabilities ‚Äì Linux (Weekly)‚Äù
* ‚ÄúTotal Vulnerabilities ‚Äì Windows (Monthly)‚Äù
* ‚ÄúSeverity Trend ‚Äì macOS‚Äù

### Thresholds and Alerting

Grafana alert rules continuously evaluate MySQL data.

Configured thresholds:

* Critical > 1000 ‚Üí red alert (Slack notification).
* High > 500 ‚Üí yellow alert (warning).

Alerts are formatted and sent automatically:

> üö® [Infrasec Alert] Vulnerability spike detected
> OS: Linux
> Severity: Critical
> Count: 129,224

This ensures immediate visibility for the Infrasec and Infrastructure teams.

## üîç Advanced Features

### False Positive Suppression
* Vulnerabilities (CVEs) identified as false positives can be added to an automated ignore list.
* Ignored entries are excluded from Grafana dashboards and MySQL queries dynamically.

### Historical Comparison
* Trendline analysis of vulnerability evolution across weeks and months.
* Detects regression in patch management or recurring CVEs.

### Top Vulnerability Insights
* Correlates software versions and vendor details.
* Automatically highlights recurring CVEs in critical or high categories.

## üìà Key Metrics
| Metric                     | Description                                          |
|----------------------------|------------------------------------------------------|
| Total vulnerabilities per OS | Breakdown by Windows, Linux, and macOS               |
| Critical vulnerability ratio | % of vulnerabilities scored CVSS ‚â• 9.0                 |
| Weekly delta               | Change in vulnerability count week over week         |
| Vendor exposure index      | Aggregated vulnerabilities by software manufacturer  |

## üöÄ Operational Benefits

* 40% reduction in analysis time for critical vulnerabilities.
* Unified visibility across the endpoint fleet.
* Fully automated pipeline from ingestion to visualization.
* Integrated real-time alerting through Slack.
* Prioritization by business impact and CVSS score.

## üß© Technical Stack
| Component         | Purpose                        | Technology                     |
|-------------------|--------------------------------|--------------------------------|
| SentinelOne API   | Data source                    | REST / JSON                    |
| Python Consumer   | Data ingestion & normalization | Python 3                       |
| Node-RED          | Orchestration & scheduling     | JavaScript (flow-based)        |
| MySQL             | Data persistence               | SQL                            |
| Grafana           | Visualization & alerting       | Web dashboards + Webhooks      |
| Slack (#infrasec) | Alerting & collaboration       | Webhook API                    |

## üìÖ Execution Schedule
| Type                 | Frequency                      | Managed By          | Description                        |
|----------------------|--------------------------------|---------------------|------------------------------------|
| Weekly               | Every Friday, 05:00            | Node-RED            | Incremental vulnerability update   |
| Monthly              | 1st business day of the month  | Node-RED            | Global dataset consolidation       |
| Real-time (Alerts)   | On threshold breach            | Grafana / Slack     | Automatic alert dispatch           |

## üìä Example Output (Production Dashboard)
| OS      | Total (Monthly) | Critical | High   | Medium | Low   |
|---------|-----------------|----------|--------|--------|-------|
| Linux   | 379,154         | 284,240  | 55,748 | 31,070 | 8,096 |
| Windows | 12,831          | 4,931    | 7,707  | 116    | 77    |
| macOS   | 2,721           | 1,444    | 864    | 147    | 266   |